const CONFIG_3D={particles:{count:1000,size:2,opacity:0.8,color:{h:0.55,s:1,l:0.6}},matrix:{fontSize:10,speed:35,opacity:0.04,color:'#4da6ff'},animation:{rotationSpeed:{x:0.0005,y:0.001},cameraZ:50}};class Header3DEffects{constructor(){this.scene=null;this.camera=null;this.renderer=null;this.particles=null;this.matrixCanvas=null;this.matrixCtx=null;this.matrixDrops=[];this.initialized=false;}init(){this.init3D();this.initMatrixRain();this.setupEventListeners();this.initialized=true;}init3D(){const container=document.getElementById('three-container');if(!container)return;if(typeof THREE==='undefined'){this.createFallbackEffect(container);return;}try{this.scene=new THREE.Scene();const aspect=window.innerWidth/window.innerHeight;this.camera=new THREE.PerspectiveCamera(75,aspect,0.1,1000);this.camera.position.z=CONFIG_3D.animation.cameraZ;this.renderer=new THREE.WebGLRenderer({alpha:true});this.renderer.setSize(window.innerWidth,window.innerHeight);container.appendChild(this.renderer.domElement);this.createParticleSystem();this.animate3D();}catch(error){console.warn('Error initializing 3D effects:',error);this.createFallbackEffect(container);}}createParticleSystem(){const{count,size,opacity,color}=CONFIG_3D.particles;const geometry=new THREE.BufferGeometry();const vertices=[];const colors=[];for(let i=0;i<count;i++){vertices.push((Math.random()-0.5)*100,(Math.random()-0.5)*100,(Math.random()-0.5)*100);const hue=color.h+(Math.random()-0.5)*0.1;const threeColor=new THREE.Color();threeColor.setHSL(hue,color.s,color.l);colors.push(threeColor.r,threeColor.g,threeColor.b);}geometry.setAttribute('position',new THREE.Float32BufferAttribute(vertices,3));geometry.setAttribute('color',new THREE.Float32BufferAttribute(colors,3));const material=new THREE.PointsMaterial({size:size,vertexColors:true,transparent:true,opacity:opacity});this.particles=new THREE.Points(geometry,material);this.scene.add(this.particles);}animate3D(){if(!this.renderer||!this.scene||!this.camera)return;requestAnimationFrame(()=>this.animate3D());if(this.particles){this.particles.rotation.x+=CONFIG_3D.animation.rotationSpeed.x;this.particles.rotation.y+=CONFIG_3D.animation.rotationSpeed.y;}this.renderer.render(this.scene,this.camera);}createFallbackEffect(container){const canvas=document.createElement('canvas');canvas.style.position='absolute';canvas.style.top='0';canvas.style.left='0';canvas.style.width='100%';canvas.style.height='100%';canvas.style.opacity='0.1';container.appendChild(canvas);const ctx=canvas.getContext('2d');canvas.width=window.innerWidth;canvas.height=window.innerHeight;const particles=[];for(let i=0;i<50;i++){particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,vx:(Math.random()-0.5)*2,vy:(Math.random()-0.5)*2,size:Math.random()*3+1,color:`hsl(${180+Math.random()*20},100%,60%)`});}const animateFallback=()=>{ctx.fillStyle='rgba(0,0,0,0.05)';ctx.fillRect(0,0,canvas.width,canvas.height);particles.forEach(particle=>{particle.x+=particle.vx;particle.y+=particle.vy;if(particle.x<0||particle.x>canvas.width)particle.vx*=-1;if(particle.y<0||particle.y>canvas.height)particle.vy*=-1;ctx.beginPath();ctx.arc(particle.x,particle.y,particle.size,0,Math.PI*2);ctx.fillStyle=particle.color;ctx.fill();});requestAnimationFrame(animateFallback);};animateFallback();}initMatrixRain(){this.matrixCanvas=document.getElementById('matrix-canvas');if(!this.matrixCanvas)return;this.matrixCtx=this.matrixCanvas.getContext('2d');this.matrixCanvas.width=window.innerWidth;this.matrixCanvas.height=window.innerHeight;const{fontSize,color}=CONFIG_3D.matrix;const columns=this.matrixCanvas.width/fontSize;for(let x=0;x<columns;x++){this.matrixDrops[x]=Math.random()*this.matrixCanvas.height;}this.animateMatrix();}animateMatrix(){if(!this.matrixCanvas||!this.matrixCtx)return;const{fontSize,speed,opacity,color}=CONFIG_3D.matrix;setTimeout(()=>{requestAnimationFrame(()=>this.animateMatrix());this.matrixCtx.fillStyle=`rgba(0,0,0,${opacity})`;this.matrixCtx.fillRect(0,0,this.matrixCanvas.width,this.matrixCanvas.height);this.matrixCtx.fillStyle=color;this.matrixCtx.font=`${fontSize}px monospace`;const matrix="ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%^&*()*&^%+-/~{[|`]}";for(let i=0;i<this.matrixDrops.length;i++){const text=matrix[Math.floor(Math.random()*matrix.length)];this.matrixCtx.fillText(text,i*fontSize,this.matrixDrops[i]);if(this.matrixDrops[i]>this.matrixCanvas.height&&Math.random()>0.975){this.matrixDrops[i]=0;}this.matrixDrops[i]+=fontSize;}},speed);}setupEventListeners(){window.addEventListener('resize',()=>this.handleResize());}handleResize(){if(this.camera&&this.renderer){this.camera.aspect=window.innerWidth/window.innerHeight;this.camera.updateProjectionMatrix();this.renderer.setSize(window.innerWidth,window.innerHeight);}if(this.matrixCanvas){this.matrixCanvas.width=window.innerWidth;this.matrixCanvas.height=window.innerHeight;}}updateTime(){const timeElement=document.getElementById('current-time');if(timeElement){const now=new Date();timeElement.textContent=now.toLocaleTimeString('es-ES',{hour12:false});}}setPageTitle(){const path=window.location.pathname;const filename=path.split('/').pop()||'index.html';const titles={'index.html':{title:'JUAMPI IA',subtitle:'RETRO FUTURE DASHBOARD v2.0.2.5'},'ia-positiva.html':{title:'IA POSITIVA',subtitle:'SISTEMAS DE IA PARA EL BIENESTAR'},'novedades.html':{title:'NOVEDADES IA',subtitle:'ÚLTIMAS NOTICIAS Y AVANCES'},'curiosidades.html':{title:'CURIOSIDADES IA',subtitle:'DATOS FASCINANTES SOBRE IA'},'robotica.html':{title:'ROBÓTICA',subtitle:'AVANCES EN ROBÓTICA Y AUTOMATIZACIÓN'},'playlist.html':{title:'PLAYLIST',subtitle:'VÍDEOS SELECCIONADOS DE IA'},'contacto.html':{title:'CONTACTO',subtitle:'TERMINAL DE COMUNICACIÓN'}};const pageInfo=titles[filename]||titles['index.html'];const titleElement=document.getElementById('page-title');const subtitleElement=document.getElementById('page-subtitle');if(titleElement)titleElement.textContent=pageInfo.title;if(subtitleElement)subtitleElement.textContent=pageInfo.subtitle;}}let header3DEffects=null;function init3D(){if(!header3DEffects){header3DEffects=new Header3DEffects();}header3DEffects.init();}function initMatrixRain(){if(!header3DEffects){header3DEffects=new Header3DEffects();}header3DEffects.initMatrixRain();}function updateTime(){if(header3DEffects){header3DEffects.updateTime();}}function setPageTitle(){if(header3DEffects){header3DEffects.setPageTitle();}}document.addEventListener('DOMContentLoaded',()=>{setTimeout(()=>{if(typeof init3D==='function'){init3D();}if(typeof initMatrixRain==='function'){initMatrixRain();}if(typeof updateTime==='function'){updateTime();setInterval(updateTime,1000);}if(typeof setPageTitle==='function'){setPageTitle();}},100);});if(typeof module!=='undefined'&&module.exports){module.exports=Header3DEffects;}